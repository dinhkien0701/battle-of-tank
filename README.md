# Tank Of Battle
 * Link demo game :
## HÆ°á»›ng dáº«n cÃ i Ä‘áº·t game 
### [Truy cáº­p vÃ o `**Releases**` Ä‘á»ƒ táº£i game ](https://github.com/dinhkien0701/battle-of-tank/releases)

* BattleOfTank_Setup.exe : Táº£i game vá» cÃ i Ä‘áº·t vÃ  chÆ¡i luÃ´n
* Source.Code.to.Build.App.zip : PhiÃªn báº£n chá»©a cáº£ file Setup Ä‘á»ƒ cÃ i game kÃ¨m mÃ£ nguá»“n Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i Ä‘á»ƒ cÃ³ thá»ƒ táº¡o á»©ng dá»¥ng hoÃ n chá»‰nh
* Battle.Of.Tank.zip : phiÃªn báº£n mÃ£ nguá»“n gá»‘c cá»§a game , chÆ°a tÃ¹y biáº¿n vÃ  cÃ³ thá»ƒ chÆ¡i 

## Giá»›i thiá»‡u
 Tá»±a game 2D Ä‘Æ¡n giáº£n , ngÆ°á»i chÆ¡i sáº½ Ä‘iá»u khiá»ƒn xe tÄƒng Ä‘á»ƒ tiÃªu diá»‡t xe tÄƒng Ä‘á»‹ch nháº±m Ä‘áº¡t Ä‘iá»ƒm cao nháº¥t cÃ³ thá»ƒ
 
![HÃ¬nh giá»›i thiá»‡u](image/loading.png)

# HÆ°á»›ng dáº«n chÆ¡i

- [HÆ°á»›ng dáº«n chÆ¡i game](#HÆ°á»›ng-dáº«n-chÆ¡i-game)

# HÃ¬nh áº£nh, Ã¢m thanh vÃ  font chá»¯

- [ThÃ´ng tin chi tiáº¿t hÃ¬nh áº£nh, Ã¢m thanh vÃ  cáº£ font chá»¯ cá»§a game](#ThÃ´ng-tin-chi-tiáº¿t-hÃ¬nh-áº£nh-Ã¢m-thanh-vÃ -cáº£-font-chá»¯-cá»§a-game)
  
# CÆ¡ cháº¿ cá»§a game

- [Äá»‘i tÆ°á»£ng](#Äá»‘i-tÆ°á»£ng)
- [TÆ°Æ¡ng tÃ¡c cá»§a Ä‘á»‘i tÆ°á»£ng ](#TÆ°Æ¡ng-tÃ¡c-cá»§a-Ä‘á»‘i-tÆ°á»£ng )
- [Äiá»u khiá»ƒn](#Äiá»u-khiá»ƒn)
- [XÃ¢y dá»±ng mÃ n chÆ¡i](#XÃ¢y-dá»±ng-mÃ n-chÆ¡i)
- [Simple AI - XÃ¢y dá»±ng AI Ä‘Æ¡n giáº£n cho game](#Simple-AI---XÃ¢y-dá»±ng-AI-Ä‘Æ¡n-giáº£n-cho-game)
---


---
## HÆ°á»›ng dáº«n chÆ¡i game
* Nháº¥p chuá»™t nÃºt `play` trÃªn mÃ n hÃ¬nh MENU Ä‘á»ƒ chÆ¡i game hoáº·c nháº¥n cÃ¡c nÃºt `ÄIá»‚M CAO` hay `HÆ¯á»šNG DáºªN` Ä‘á»ƒ dÃ¹ng chá»©c nÄƒng khÃ¡c
  
---  
  ![HÃ¬nh giá»›i thiá»‡u](image/img_2.png)

---
  ![HÃ¬nh giá»›i thiá»‡u](image/img_4.png)

---
  ![HÃ¬nh giá»›i thiá»‡u](image/img_3.png)

  
* Má»—i ngÆ°á»i chÆ¡i sáº½ báº¯t Ä‘áº§u vá»›i 3 máº¡ng , viá»‡c vÆ°á»£t qua má»—i level sáº½ giÃºp ngÆ°á»i chÆ¡i  tÄƒng thÃªm má»™t máº¡ng
* NgÆ°á»i chÆ¡i cÃ³ thá»ƒ Ä‘iá»u khiá»ƒn di chuyá»ƒn theo bá»‘n hÆ°á»›ng  W(lÃªn) , S (xuá»‘ng) , A(trÃ¡i) , D(pháº£i) Ä‘á»ƒ di chuyá»ƒn ( cÃ³ thá»ƒ dÃ¹ng phÃ­m mÅ©i tÃªn Ä‘á»ƒ di chuyá»ƒn )
* Sá»­ dá»¥ng phÃ­m SPACE Ä‘á»ƒ  báº¯n Ä‘áº¡n táº¥n cÃ´ng Ä‘á»‹ch
  
    ![HÃ¬nh giá»›i thiá»‡u](image/img_5.png)
  
  ---
    ![HÃ¬nh giá»›i thiá»‡u](image/img_6.png)


* Nháº¥n phÃ­m P Ä‘á»ƒ  Táº M Dá»ªNG / TIáº¾P Tá»¤C chÆ¡i game

  ---
   ![HÃ¬nh giá»›i thiá»‡u](image/img_8.png)

* Nháº¥n phÃ­m M Ä‘á»ƒ thoÃ¡t khá»i vÃ¡n Ä‘áº¥u , trá»Ÿ vá» mÃ n hÃ¬nh  MENU
 ### CÃ¡ch thá»©c táº¥n cÃ´ng
* Bá»‹ Ä‘áº¡n Ä‘á»‹ch trÃºng sáº½ máº¥t má»™t máº¡ng , khi sá»‘ máº¡ng vá» 0 sáº½ coi nhÆ° káº¿t thÃºc vÃ¡n Ä‘áº¥u
* Äáº¡n cá»§a nhÃ¢n váº­t trÃºng Ä‘á»‹ch sáº½  tiÃªu diá»‡t káº» Ä‘á»‹ch Ä‘Ã³ , cÃ¡c bá»©c tÆ°á»ng chá»‹u tá»‘i Ä‘a 3 láº§n trÃºng Ä‘áº¡n , sau khi trÃºng Ä‘áº¡n láº§n thá»© 3 tÆ°á»ng sáº½ sáº­p!

  ---
  ![HÃ¬nh giá»›i thiá»‡u](image/img_7.png)
  
---

## ThÃ´ng tin chi tiáº¿t hÃ¬nh áº£nh, Ã¢m thanh vÃ  cáº£ font chá»¯ cá»§a game

* Ã‚m thanh táº£i trÃªn máº¡ng internet : youtube.com vÃ  tiengdong.com.
* HÃ¬nh áº£nh cáº¯t tá»« game , tá»± váº½ , táº£i trÃªn máº¡ng vÃ  sá»­ dá»¥ng AI táº¡o áº£nh.
* Font chá»¯ táº£i xuá»‘ng tá»« Google Font.
### [**File Ã¢m thanh cá»§a game**](music)
### [**File hÃ¬nh áº£nh cá»§a game**](image)
### [**File font chá»¯ cá»§a game**](font)

### Giá»›i thiá»‡u cÃ¡c hÃ¬nh áº£nh Ä‘á»‘i tÆ°á»£ng trong game

 - HÃ¬nh áº£nh xe tÄƒng cá»§a ngÆ°á»i chÆ¡i (player / nhÃ¢n váº­t )  <img src="image/xe.png" alt="Xe tÄƒng trong game" width="60" height="60">   vÃ   Ä‘áº¡n tÆ°Æ¡ng á»©ng vá»›i xe tÄƒng nÃ y lÃ     <img src="image/dan_do.png" alt="Xe tÄƒng trong game" width="20" height="20">


 - HÃ¬nh áº£nh xe tÄƒng cá»§a Ä‘á»‹ch ( enemy )  <img src="image/xe_dich.png" alt="Xe tÄƒng trong game" width="60" height="60">   vÃ   Ä‘áº¡n tÆ°Æ¡ng á»©ng vá»›i xe tÄƒng nÃ y lÃ     <img src="image/dan_den.png" alt="Xe tÄƒng trong game" width="20" height="20">
 

 - HÃ¬nh áº£nh bá»©c tÆ°á»ng ( wall / váº­t cáº£n )   <img src="image/tuong.png" alt="Xe tÄƒng trong game" width="60" height="60">

 
---
# CÆ¡ cháº¿ cá»§a game
---
## Äá»‘i tÆ°á»£ng
### [Cáº¥u trÃºc cá»§a Ä‘á»‘i tÆ°á»£ng - xem code](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.h#L9-L103)

1. [NhÃ¢n váº­t (Xe tÄƒng ngÆ°á»i chÆ¡i)](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.h#L23-L30)
* NhÃ¢n váº­t trong trÃ² chÆ¡i Ä‘Æ°á»£c Ä‘á»‹nh danh thÃ´ng qua id
  
* [attribute = 2] : Ä‘Ã¢y lÃ  thuá»™c tÃ­nh Ä‘Æ°á»£c khá»Ÿi táº¡o Ä‘á»ƒ phÃ¢n biá»‡t nÃ³ vá»›i cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ¡c

* [angle]: Xe tÄƒng luÃ´n báº¯t Ä‘áº§u á»Ÿ hÆ°á»›ng 270 Ä‘á»™ (hÆ°á»›ng Báº¯c), xÃ¡c Ä‘á»‹nh gÃ³c mÃ  xe tÄƒng di chuyá»ƒn hoáº·c báº¯n.

* [clock]: CÆ¡ cháº¿ báº¯n cá»§a nhÃ¢n váº­t tÃ­ch Ä‘á»§ 15 khung hÃ¬nh (FPS) Ä‘á»ƒ thá»±c hiá»‡n má»™t láº§n báº¯n, mang láº¡i cáº£m giÃ¡c hÃ nh Ä‘á»™ng liÃªn tá»¥c nhÆ°ng cÃ³ kiá»ƒm soÃ¡t.

* [defense]: GiÃ¡p báº£o vá»‡, giÃºp xe tÄƒng chá»‘ng chá»‹u sÃ¡t thÆ°Æ¡ng.

* [Vá»‹ trÃ­ (rect)]: ÄÆ°á»£c lÆ°u trá»¯ trong má»™t hÃ¬nh chá»¯ nháº­t SDL (SDL_Rect), Ä‘áº¡i diá»‡n cho tá»a Ä‘á»™ vÃ  kÃ­ch thÆ°á»›c trÃªn mÃ n hÃ¬nh.

2. [Äá»‹ch (Xe tÄƒng Ä‘á»‹ch)](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.h#L31-L43) :Äá»‘i vá»›i xe tÄƒng Ä‘á»‹ch, OBJ thÃªm vÃ o cÃ¡c hÃ nh vi Ä‘á»™c Ä‘Ã¡o vÃ  thÃ´ng minh:

* [attribute = 1] : Äá»‹nh danh Ä‘Ã¢y lÃ  má»™t Ä‘á»‘i tÆ°á»£ng Ä‘á»‹ch.

* [rand_shot] : CÆ¡ cháº¿ báº¯n ngáº«u nhiÃªn Ä‘Æ°á»£c khá»Ÿi táº¡o, vá»›i thá»i gian báº¯n Ä‘á»‹nh ká»³ má»—i 2 giÃ¢y, táº¡o nÃªn sá»± báº¥t ngá» vÃ  thÃ¡ch thá»©c.

* [HÆ°á»›ng di chuyá»ƒn - angle ] : Äá»‹ch Ä‘Æ°á»£c khá»Ÿi táº¡o vá»›i gÃ³c 270 Ä‘á»™ vÃ  thá»i gian thay Ä‘á»•i hÆ°á»›ng thÃ´ng qua clock, sinh ngáº«u nhiÃªn Ä‘á»ƒ Ä‘áº£m báº£o hÃ nh Ä‘á»™ng linh hoáº¡t.

* [Vá»‹ trÃ­ (rect)] : Tá»a Ä‘á»™ vÃ  kÃ­ch thÆ°á»›c cá»§a Ä‘á»‹ch Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a giÃºp dá»… dÃ ng hiá»ƒn thá»‹ vÃ  kiá»ƒm tra va cháº¡m vá»›i cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ¡c.

3. [Váº­t cáº£n (TÆ°á»ng)](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.h#L45-L53) :TÆ°á»ng Ä‘Ã³ng vai trÃ² nhÆ° chÆ°á»›ng ngáº¡i váº­t trong trÃ² chÆ¡i

* [attribute = 3]: Thuá»™c tÃ­nh xÃ¡c Ä‘á»‹nh Ä‘Ã¢y lÃ  tÆ°á»ng.

* [defense] : TÆ°á»ng báº¯t Ä‘áº§u vá»›i giÃ¡p lÃ  3, yÃªu cáº§u ngÆ°á»i chÆ¡i hoáº·c Ä‘á»‹ch pháº£i phÃ¡ há»§y Ä‘á»ƒ di chuyá»ƒn qua.

* [rect] : Äá»‹nh nghÄ©a vá»‹ trÃ­ vÃ  kÃ­ch thÆ°á»›c cá»§a tÆ°á»ng trÃªn mÃ n hÃ¬nh.

* => Vai trÃ²: TÆ°á»ng thÃªm chiá»u sÃ¢u chiáº¿n thuáº­t báº±ng cÃ¡ch cáº£n trá»Ÿ di chuyá»ƒn cá»§a cÃ¡c Ä‘á»‘i tÆ°á»£ng.

4. [Äáº¡n](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.h#L54-L79)  ( Äáº¡n Ä‘Æ°á»£c sinh ra tá»« cáº£ nhÃ¢n váº­t vÃ  Ä‘á»‹ch Ä‘á»ƒ táº¡o ra hÃ nh Ä‘á»™ng )

* [rect]  : KÃ­ch thÆ°á»›c nhá» gá»n (10x10) vÃ  tá»a Ä‘á»™ khá»Ÿi táº¡o dá»±a trÃªn vá»‹ trÃ­ vÃ  gÃ³c cá»§a Ä‘á»‘i tÆ°á»£ng báº¯n.

* [angle] : HÆ°á»›ng cá»§a viÃªn Ä‘áº¡n phá»¥ thuá»™c hoÃ n toÃ n vÃ o gÃ³c báº¯n cá»§a Ä‘á»‘i tÆ°á»£ng táº¡o ra nÃ³.

* [attribute] : Loáº¡i Ä‘áº¡n Ä‘Æ°á»£c liÃªn káº¿t vá»›i loáº¡i Ä‘á»‘i tÆ°á»£ng (vÃ­ dá»¥: Ä‘áº¡n cá»§a Ä‘á»‹ch khÃ¡c vá»›i Ä‘áº¡n cá»§a ngÆ°á»i chÆ¡i) .

5. [CÃ¡c chá»©c nÄƒng há»— trá»£](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.h#L81-L103)
   
* `xoa_obj()` : XÃ³a Ä‘á»‘i tÆ°á»£ng khá»i trÃ² chÆ¡i báº±ng cÃ¡ch Ä‘áº·t id = -1, biá»ƒu thá»‹ ráº±ng Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ bá»‹ loáº¡i bá» ( gáº§n nhÆ° khÃ´ng dÃ¹ng :]] )

* `tiep_xuc()` : Kiá»ƒm tra va cháº¡m giá»¯a hai Ä‘á»‘i tÆ°á»£ng, tá»« xe tÄƒng cháº¡m vÃ o tÆ°á»ng cho Ä‘áº¿n Ä‘áº¡n cháº¡m vÃ o Ä‘á»‹ch.

* `print_obj()` : Hiá»ƒn thá»‹ Ä‘á»‘i tÆ°á»£ng lÃªn mÃ n hÃ¬nh vá»›i gÃ³c xoay vÃ  vá»‹ trÃ­ chÃ­nh xÃ¡c.

### [Khá»Ÿi táº¡o báº£n Ä‘á»“ Ä‘á»‘i tÆ°á»£ng - xem code](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.cpp#L34-L141)

#### XÃ¢y dá»±ng báº£n Ä‘á»“ ban Ä‘áº§u:
[HÃ m `map_khoi_dong`](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.cpp#L51-L139) Ä‘áº£m nháº­n viá»‡c táº¡o ra má»™t báº£n Ä‘á»“ gá»“m cÃ¡c Ä‘á»‘i tÆ°á»£ng nhÆ° nhÃ¢n váº­t chÃ­nh, Ä‘á»‹ch, vÃ  tÆ°á»ng. Má»—i Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c Ä‘á»‹nh vá»‹ theo level hiá»‡n táº¡i, giÃºp game tÄƒng Ä‘á»™ khÃ³ theo thá»i gian. 

**CÃ¡c bÆ°á»›c táº¡o báº£n Ä‘á»“ bao gá»“m trong hÃ m `map_khoi_dong` :**
- **Cáº¥p tháº¥p (Level < 3):** Vá»‹ trÃ­ nhÃ¢n váº­t chÃ­nh vÃ  Ä‘á»‹ch Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a cá»¥ thá»ƒ. TÆ°á»ng Ä‘Æ°á»£c Ä‘áº·t táº¡i cÃ¡c vá»‹ trÃ­ cá»‘ Ä‘á»‹nh, dá»… dÃ ng cho ngÆ°á»i chÆ¡i lÃ m quen.
- **Cáº¥p Ä‘á»™ cao (Level â‰¥ 4):** Vá»‹ trÃ­ nhÃ¢n váº­t chÃ­nh vÃ  Ä‘á»‹ch Ä‘Æ°á»£c sinh ngáº«u nhiÃªn, Ä‘áº£m báº£o sá»± Ä‘a dáº¡ng. TÆ°á»ng Ä‘Æ°á»£c khá»Ÿi táº¡o vá»›i sá»‘ lÆ°á»£ng tÄƒng theo level, tá»‘i Ä‘a 260 bá»©c tÆ°á»ng vÃ  tá»‘i Ä‘a 30 káº» Ä‘á»‹ch.
- **Game coi nhÆ° má»™t game vÃ´ háº¡n cáº¥p Ä‘á»™ má»¥c tiÃªu tiÃªu diá»‡t cÃ ng nhiá»u cÃ ng tá»‘t xe tÄƒng Ä‘á»‹ch**
  
#### **[HÃ m `dfs_map` - Sinh cÃ¡c bá»©c tÆ°á»ng ngáº«u nhiÃªn](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.cpp#L38-L50)**

HÃ m `dfs_map` Ä‘áº£m nháº­n nhiá»‡m vá»¥ sinh cÃ¡c bá»©c tÆ°á»ng trong báº£n Ä‘á»“ má»™t cÃ¡ch ngáº«u nhiÃªn, Ä‘áº£m báº£o má»—i mÃ n chÆ¡i Ä‘á»u mang láº¡i sá»± má»›i máº» vÃ  thá»­ thÃ¡ch. DÆ°á»›i Ä‘Ã¢y lÃ  chi tiáº¿t tá»«ng bÆ°á»›c hoáº¡t Ä‘á»™ng cá»§a hÃ m:

1. **ÄÃ¡nh dáº¥u Ã´ hiá»‡n táº¡i lÃ  tÆ°á»ng:**
   - Khi hÃ m Ä‘Æ°á»£c gá»i táº¡i vá»‹ trÃ­ `(i, j)`, Ã´ Ä‘Ã³ sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  tÆ°á»ng:
     ```cpp
     map_of_level[i][j] = 1; // ÄÃ¡nh dáº¥u Ã´ hiá»‡n táº¡i lÃ  tÆ°á»ng (1).
     ```

2. **Sinh sá»‘ nhÃ¡nh má»Ÿ rá»™ng ngáº«u nhiÃªn:**
   - HÃ m sinh tá»« 1 Ä‘áº¿n 3 nhÃ¡nh ngáº«u nhiÃªn tá»« Ã´ hiá»‡n táº¡i, sá»­ dá»¥ng cÃ´ng thá»©c:
     ```cpp
     for (int num = rand() % 3 + 1; num > 0; num--) { ... }
     ```

3. **Kiá»ƒm tra Ä‘iá»u kiá»‡n má»Ÿ rá»™ng:**
   - CÃ¡c Ä‘iá»u kiá»‡n sau giÃºp kiá»ƒm soÃ¡t logic má»Ÿ rá»™ng:
     - **`res == 2`:** Giá»›i háº¡n sá»‘ nhÃ¡nh tá»‘i Ä‘a tá»« má»—i Ã´ lÃ  2, trÃ¡nh táº¡o cáº¥u trÃºc tÆ°á»ng quÃ¡ phá»©c táº¡p.
     - **`total >= max_total`:** Ngá»«ng táº¡o tÆ°á»ng náº¿u tá»•ng sá»‘ Ä‘Ã£ Ä‘áº¡t giá»›i háº¡n tá»‘i Ä‘a.

4. **Sinh bÆ°á»›c dá»‹ch chuyá»ƒn ngáº«u nhiÃªn:**
   - Dá»‹ch chuyá»ƒn sang cÃ¡c Ã´ gáº§n ká» theo tá»a Ä‘á»™ `(x, y)` ngáº«u nhiÃªn:
     ```cpp
     int x = rand() % 2 - rand() % 2; // Dá»‹ch chuyá»ƒn theo trá»¥c x (-1, 0, 1).
     int y = rand() % 2 - rand() % 2; // Dá»‹ch chuyá»ƒn theo trá»¥c y (-1, 0, 1).
     ```

5. **Kiá»ƒm tra há»£p lá»‡:**
   - Náº¿u Ã´ má»›i náº±m ngoÃ i biÃªn hoáº·c Ä‘Ã£ cÃ³ tÆ°á»ng, bá» qua:
     ```cpp
     if (x < 0 || x > 32 || y < 1 || y > 18 || map_of_level[i + x][j + y]) continue;
     ```

6. **Gá»i Ä‘á»‡ quy:**
   - Náº¿u há»£p lá»‡, hÃ m Ä‘Æ°á»£c gá»i láº¡i Ä‘á»ƒ má»Ÿ rá»™ng cáº¥u trÃºc tÆ°á»ng:
     ```cpp
     dfs_map(i + x, j + y, map_of_level, ++total, max_total);
     ```

---

#### **Logic kiá»ƒm tra khoáº£ng cÃ¡ch:**

Trong hÃ m `map_khoi_dong`, logic kiá»ƒm tra khoáº£ng cÃ¡ch giá»¯a nhÃ¢n váº­t chÃ­nh vÃ  Ä‘á»‹ch Ä‘Æ°á»£c triá»ƒn khai nhÆ° sau:

```cpp
while (mapp[x][y] > 0 || sqrt((cx - x) * (cx - x) + (cy - y) * (cy - y)) < 9);
```
---
#### [GÃ¡n Ä‘á»‘i tÆ°á»£ng vÃ o báº£n Ä‘á»“:](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/co_che.cpp#L109-L139)
Sau khi báº£n Ä‘á»“ Ä‘Æ°á»£c táº¡o, cÃ¡c Ä‘á»‘i tÆ°á»£ng (nhÃ¢n váº­t, Ä‘á»‹ch, vÃ  tÆ°á»ng) Ä‘Æ°á»£c khá»Ÿi táº¡o vÃ  thÃªm vÃ o danh sÃ¡ch Ä‘á»‘i tÆ°á»£ng tÆ°Æ¡ng á»©ng (`make_enemy`, `make_obj`). Äiá»u nÃ y giÃºp dá»… dÃ ng quáº£n lÃ½ vÃ  hiá»ƒn thá»‹ cÃ¡c Ä‘á»‘i tÆ°á»£ng trong mÃ n chÆ¡i.

#### Vai trÃ² vÃ  cÆ¡ cháº¿ nÃ¢ng cáº¥p:
- **NhÃ¢n váº­t chÃ­nh:** LuÃ´n khá»Ÿi Ä‘áº§u vá»›i gÃ³c 270 Ä‘á»™ vÃ  Ä‘Æ°á»£c thÆ°á»Ÿng thÃªm máº¡ng má»—i level.
- **Äá»‹ch:** TÄƒng sá»‘ lÆ°á»£ng vÃ  hÃ nh vi linh hoáº¡t khi level cao.
- **TÆ°á»ng:** Sá»‘ lÆ°á»£ng tÆ°á»ng tÄƒng theo level, Ä‘Ã²i há»i ngÆ°á»i chÆ¡i pháº£i phÃ¡ há»§y Ä‘á»ƒ má»Ÿ Ä‘Æ°á»ng di chuyá»ƒn.

#### Äiá»ƒm ná»•i báº­t cá»§a cÆ¡ cháº¿ khá»Ÿi táº¡o:
- **Sá»± ngáº«u nhiÃªn:** Má»—i mÃ n chÆ¡i mang láº¡i tráº£i nghiá»‡m má»›i, khÃ´ng láº·p láº¡i, giÃºp ngÆ°á»i chÆ¡i khÃ´ng nhÃ m chÃ¡n.
- **Chiáº¿n thuáº­t:** TÆ°á»ng Ä‘Æ°á»£c Ä‘áº·t thÃ´ng minh Ä‘á»ƒ táº¡o thá»­ thÃ¡ch, káº¿t há»£p vá»›i vá»‹ trÃ­ káº» Ä‘á»‹ch Ä‘á»ƒ ngÆ°á»i chÆ¡i pháº£i suy nghÄ© ká»¹ trÆ°á»›c khi hÃ nh Ä‘á»™ng.
- **Hiá»‡u quáº£:** CÃ¡ch tá»• chá»©c mÃ£ nguá»“n giÃºp quáº£n lÃ½ Ä‘á»‘i tÆ°á»£ng dá»… dÃ ng, má»Ÿ rá»™ng logic cho cÃ¡c cáº¥p Ä‘á»™ khÃ³ hÆ¡n.

## TÆ°Æ¡ng tÃ¡c cá»§a Ä‘á»‘i tÆ°á»£ng 

#### **[1. HÃ m `kiem_tra_va_cham`](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L172-L199)**

HÃ m nÃ y kiá»ƒm tra va cháº¡m cá»§a má»™t Ä‘á»‘i tÆ°á»£ng `obj` vá»›i cÃ¡c Ä‘á»‘i tÆ°á»£ng khÃ¡c nhÆ° nhÃ¢n váº­t chÃ­nh, káº» Ä‘á»‹ch, vÃ  tÆ°á»ng trong báº£n Ä‘á»“. ÄÃ¢y lÃ  logic quan trá»ng Ä‘á»ƒ Ä‘áº£m báº£o cÃ¡c hÃ nh Ä‘á»™ng trong game diá»…n ra chÃ­nh xÃ¡c.

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
1.1. **Kiá»ƒm tra giá»›i háº¡n mÃ n hÃ¬nh:**
   - Náº¿u Ä‘á»‘i tÆ°á»£ng `obj` vÆ°á»£t ra khá»i giá»›i háº¡n mÃ n hÃ¬nh, hÃ m sáº½ tráº£ vá» `true` (Ä‘Ã£ va cháº¡m).
     ```cpp
     if(x<0 || x+w>1320 || y<40 || y+h>760) {
         return true;
     }
     ```

1.2. **Chuyá»ƒn Ä‘á»•i tá»a Ä‘á»™ sang lÆ°á»›i báº£n Ä‘á»“:**
   - Tá»a Ä‘á»™ cá»§a Ä‘á»‘i tÆ°á»£ng Ä‘Æ°á»£c quy Ä‘á»•i sang Ã´ lÆ°á»›i (`40x40`) trÃªn báº£n Ä‘á»“.
     ```cpp
     w = (x + w - 1) / 40;
     h = (y + h - 1) / 40;
     x /= 40; 
     y /= 40;
     ```

1.3. **Kiá»ƒm tra va cháº¡m vá»›i tÆ°á»ng:**
   - Náº¿u báº¥t ká»³ Ã´ nÃ o trong lÆ°á»›i cÃ³ giÃ¡ trá»‹ `< 0` (tÆ°á»ng), hÃ m tráº£ vá» `true`.
     ```cpp
     if(bfs_map[x][y] < 0 || bfs_map[x][h] < 0 || bfs_map[w][y] < 0 || bfs_map[w][h] < 0) {
         return true;
     }
     ```

1.4. **Kiá»ƒm tra va cháº¡m vá»›i nhÃ¢n váº­t chÃ­nh:**
   - Náº¿u `obj` khÃ´ng pháº£i nhÃ¢n váº­t chÃ­nh, hÃ m kiá»ƒm tra va cháº¡m trá»±c tiáº¿p báº±ng `tiep_xuc`.
     ```cpp
     if(obj.id != player.id) {
         if(obj.tiep_xuc(player)) return true;
     }
     ```

1.5. **Kiá»ƒm tra va cháº¡m vá»›i káº» Ä‘á»‹ch:**
   - Duyá»‡t qua danh sÃ¡ch káº» Ä‘á»‹ch (`enemy_list`) Ä‘á»ƒ kiá»ƒm tra va cháº¡m. Náº¿u `obj` cháº¡m vÃ o báº¥t ká»³ káº» Ä‘á»‹ch nÃ o (trá»« Ä‘á»‘i tÆ°á»£ng Ä‘Ã£ bá»‹ loáº¡i bá» `id = -1`), hÃ m tráº£ vá» `true`.

#### **[2. HÃ m `kiem_tra_duong_dan`:](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L340-L385)**

HÃ m nÃ y kiá»ƒm tra Ä‘Æ°á»ng Ä‘i cá»§a má»™t Ä‘á»‘i tÆ°á»£ng `obj` nhÆ° Ä‘áº¡n, bao gá»“m va cháº¡m vá»›i tÆ°á»ng, nhÃ¢n váº­t chÃ­nh, hoáº·c káº» Ä‘á»‹ch.

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
2.1. **Kiá»ƒm tra giá»›i háº¡n mÃ n hÃ¬nh:**
   - TÆ°Æ¡ng tá»± nhÆ° hÃ m `kiem_tra_va_cham`, náº¿u Ä‘á»‘i tÆ°á»£ng vÆ°á»£t khá»i giá»›i háº¡n, tráº£ vá» `true`.
     ```cpp
     if(x<0 || x+w>1320 || y<40 || y+h>760) {
         return true;
     }
     ```

2.2. **Kiá»ƒm tra va cháº¡m vá»›i tÆ°á»ng:**
   - Giáº£m `defense` cá»§a tÆ°á»ng khi Ä‘áº¡n va cháº¡m vÃ o. Náº¿u `defense` giáº£m vá» 0, tÆ°á»ng sáº½ bá»‹ phÃ¡ há»§y.
     ```cpp
     if(wall_map[x][y] > 0) {
         ans = true;
         wall_list[wall_map[x][y]].defense -= 1;
     }
     ```

2.3. **Kiá»ƒm tra va cháº¡m vá»›i nhÃ¢n váº­t chÃ­nh:**
   - Náº¿u Ä‘áº¡n khÃ´ng cÃ¹ng thuá»™c tÃ­nh vá»›i nhÃ¢n váº­t chÃ­nh vÃ  xáº£y ra va cháº¡m, `defense` cá»§a nhÃ¢n váº­t giáº£m Ä‘i 1.
     ```cpp
     if(obj.attribute != player.attribute) {
         if(obj.tiep_xuc(player)) {
             ans = true;
             player.defense -= 1;
         }
     }
     ```

2.4. **Kiá»ƒm tra va cháº¡m vá»›i káº» Ä‘á»‹ch:**
   - Náº¿u Ä‘áº¡n cháº¡m vÃ o káº» Ä‘á»‹ch cÃ³ thuá»™c tÃ­nh khÃ¡c, káº» Ä‘á»‹ch sáº½ bá»‹ xÃ³a (`id = -2`) vÃ  tráº£ vá» `true`.
     ```cpp
     if((enemy_list[i].attribute != obj.attribute) && obj.tiep_xuc(enemy_list[i])) {
         enemy_list[i].id = -2;
         ans = true;
     }
     ```

#### **[3. HÃ m `cham_tuong`:](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L387-L389)**

HÃ m kiá»ƒm tra xem má»™t tá»a Ä‘á»™ `(x, y)` cÃ³ cháº¡m pháº£i tÆ°á»ng trong báº£n Ä‘á»“ BFS (`bfs_map`) hay khÃ´ng.

**CÃ¡ch hoáº¡t Ä‘á»™ng:**
**Kiá»ƒm tra giÃ¡ trá»‹ BFS:**
   - Náº¿u giÃ¡ trá»‹ táº¡i vá»‹ trÃ­ `(x / 40, y / 40)` nhá» hÆ¡n `0`, hÃ m tráº£ vá» `true` (Ä‘Ã£ cháº¡m tÆ°á»ng).
     ```cpp
     return bfs_map[x / 40][y / 40] < 0;
     ```

---

### **Ã nghÄ©a vÃ  vai trÃ² cá»§a cÃ¡c hÃ m:**

1. **`kiem_tra_va_cham`:**
   - Äáº£m báº£o cÃ¡c Ä‘á»‘i tÆ°á»£ng trong game khÃ´ng vÆ°á»£t giá»›i háº¡n hoáº·c va cháº¡m khÃ´ng mong muá»‘n. 
   - Quáº£n lÃ½ tráº¡ng thÃ¡i cá»§a Ä‘á»‘i tÆ°á»£ng, vÃ­ dá»¥ nhÆ° loáº¡i bá» Ä‘á»‹ch khi cÃ³ va cháº¡m.

2. **`kiem_tra_duong_dan`:**
   - LÃ m rÃµ cÃ¡ch cÃ¡c váº­t thá»ƒ di chuyá»ƒn vÃ  tÆ°Æ¡ng tÃ¡c (Ä‘áº¡n, tÆ°á»ng, nhÃ¢n váº­t). 
   - Táº¡o cÆ¡ cháº¿ phÃ¡ há»§y tÆ°á»ng vÃ  giáº£m máº¡ng khi bá»‹ báº¯n trÃºng.

3. **`cham_tuong`:**
   - Cung cáº¥p má»™t cÃ¡ch kiá»ƒm tra nhanh Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem Ä‘á»‘i tÆ°á»£ng cÃ³ thá»ƒ di chuyá»ƒn vÃ o má»™t vá»‹ trÃ­ cá»¥ thá»ƒ hay khÃ´ng.

Nhá»¯ng hÃ m nÃ y lÃ  ná»n táº£ng cho cÆ¡ cháº¿ chiáº¿n Ä‘áº¥u vÃ  tÆ°Æ¡ng tÃ¡c trong **Tank Of Battle**, mang láº¡i sá»± phá»©c táº¡p vÃ  tÃ­nh chiáº¿n thuáº­t cao cho trÃ² chÆ¡i ğŸš€ğŸ®âœ¨


## Äiá»u khiá»ƒn

### **[HÃ m kiá»ƒm tra Event (thao tÃ¡c Ä‘iá»u khiá»ƒn Ä‘Æ¡n giáº£n)](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L109-L166)**

HÃ m `handleEvent` chá»‹u trÃ¡ch nhiá»‡m xá»­ lÃ½ cÃ¡c thao tÃ¡c Ä‘iá»u khiá»ƒn trong trÃ² chÆ¡i. Tá»« viá»‡c di chuyá»ƒn nhÃ¢n váº­t Ä‘áº¿n báº¯n Ä‘áº¡n vÃ  táº¡m dá»«ng, hÃ m nÃ y Ä‘áº£m báº£o má»—i hÃ nh Ä‘á»™ng cá»§a ngÆ°á»i chÆ¡i Ä‘Æ°á»£c pháº£n há»“i Ä‘Ãºng cÃ¡ch.

#### **Chi tiáº¿t hÃ m `handleEvent`:**

1. **Xá»­ lÃ½ sá»± kiá»‡n Ä‘Ã³ng cá»­a sá»•:**
   - Nháº­n yÃªu cáº§u Ä‘Ã³ng cá»­a sá»• tá»« ngÆ°á»i chÆ¡i báº±ng cÃ¡ch láº¯ng nghe `SDL_QUIT`.
     ```cpp
     case SDL_QUIT:
         exit(0);
         break;
     ```

2. **Xá»­ lÃ½ sá»± kiá»‡n phÃ­m báº¥m:**
   - PhÃ­m báº¥m Ä‘iá»u khiá»ƒn nhÃ¢n váº­t:
     - W / mÅ©i tÃªn lÃªn: Di chuyá»ƒn lÃªn.
     - S / mÅ©i tÃªn xuá»‘ng: Di chuyá»ƒn xuá»‘ng.
     - A / mÅ©i tÃªn trÃ¡i: Di chuyá»ƒn sang trÃ¡i.
     - D / mÅ©i tÃªn pháº£i: Di chuyá»ƒn sang pháº£i.
     ```cpp
     case SDLK_w:
         upy++;
         break;
     case SDLK_s:
         upy--;
         break;
     case SDLK_a:
         upx--;
         break;
     case SDLK_d:
         upx++;
         break;
     ```

   - SPACE: Báº¯n Ä‘áº¡n.
   - P: Táº¡m dá»«ng hoáº·c tiáº¿p tá»¥c trÃ² chÆ¡i.
   - M: ThoÃ¡t mÃ n chÆ¡i, trá»Ÿ vá» menu.
     ```cpp
     case SDLK_SPACE:
         ban_dan = true;
         break;
     case SDLK_p:
         pause = (!pause);
         break;
     case SDLK_m:
         back_to_menu = true;
         break;
     ```

3. **Xá»­ lÃ½ sá»± kiá»‡n chuá»™t:**
   - Kiá»ƒm tra náº¿u chuá»™t trÃ¡i Ä‘Æ°á»£c nháº¥n Ä‘á»ƒ láº¥y vá»‹ trÃ­ `(x, y)` cá»§a Ä‘iá»ƒm báº¥m.
     ```cpp
     case SDL_MOUSEBUTTONDOWN:
         if(event.button.button == SDL_BUTTON_LEFT) {
             mouse_left.first = event.button.x;
             mouse_left.second = event.button.y;
         }
         break;
     ```

---

### **HÃ m Ä‘iá»u khiá»ƒn cá»§a ngÆ°á»i chÆ¡i**

HÃ m `lua_chon` Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ xá»­ lÃ½ hÃ nh vi di chuyá»ƒn cá»§a nhÃ¢n váº­t chÃ­nh (xe tÄƒng ngÆ°á»i chÆ¡i) trong trÃ² chÆ¡i, bao gá»“m viá»‡c thay Ä‘á»•i hÆ°á»›ng vÃ  xá»­ lÃ½ va cháº¡m.

#### **[Chi tiáº¿t hÃ m `lua_chon`:](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L391-L475)**

1. **XÃ¡c Ä‘á»‹nh hÆ°á»›ng di chuyá»ƒn:**
   - Dá»±a trÃªn giÃ¡ trá»‹ cá»§a `upx` (di chuyá»ƒn ngang) vÃ  `upy` (di chuyá»ƒn dá»c), hÆ°á»›ng di chuyá»ƒn cá»§a nhÃ¢n váº­t Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh:
     ```cpp
     if(abs(upx) >= abs(upy)) {
         if(upx > 0) player.angle = 0;
         else if(upx < 0) player.angle = 180;
     } else {
         if(upy > 0) player.angle = 270;
         else if(upy < 0) player.angle = 90;
     }
     ```

2. **Kiá»ƒm tra va cháº¡m trÆ°á»›c khi di chuyá»ƒn:**
   - Táº¡o Ä‘á»‘i tÆ°á»£ng thá»­ nghiá»‡m `player_test` Ä‘á»ƒ kiá»ƒm tra kháº£ nÄƒng di chuyá»ƒn vÃ o vá»‹ trÃ­ má»›i:
     ```cpp
     new_obj_location(player_test.rect, player_test.angle, 4);
     if(kiem_tra_va_cham(player_test, player_test, enemy_list, total_enemy, bfs_map) == false) {
         player = player_test;
     }
     ```

3. **CÆ¡ cháº¿ trÆ°á»£t tÆ°á»ng:**
   - Náº¿u va cháº¡m vá»›i tÆ°á»ng, nhÃ¢n váº­t sáº½ "trÆ°á»£t" lÃªn hoáº·c xuá»‘ng Ä‘á»ƒ trÃ¡nh Ä‘á»©ng yÃªn:
     ```cpp
     if(cham_tuong(w, y, bfs_map) ^ cham_tuong(w, h, bfs_map)) {
         OBJ T1 = player;
         OBJ T2 = player;
         T1.rect.y -= 2;
         T2.rect.y += 2;
         if(cham_tuong(w, y, bfs_map) == false && kiem_tra_va_cham(T1, T1, enemy_list, total_enemy, bfs_map) == false) {
             player = T1;
         } else if(cham_tuong(w, h, bfs_map) == false && kiem_tra_va_cham(T2, T2, enemy_list, total_enemy, bfs_map) == false) {
             player = T2;
         }
     }
     ```

4. **Äáº·t láº¡i tráº¡ng thÃ¡i di chuyá»ƒn:**
   - Sau khi xá»­ lÃ½, giÃ¡ trá»‹ `upx` vÃ  `upy` Ä‘Æ°á»£c Ä‘áº·t láº¡i vá» 0:
     ```cpp
     upx = upy = 0;
     ```

---

### **Giá»›i thiá»‡u chung vá» hÃ m pháº£n há»“i Ä‘iá»u khiá»ƒn**

- **`handleEvent`:** Äáº£m báº£o má»i thao tÃ¡c cá»§a ngÆ°á»i chÆ¡i (phÃ­m báº¥m, chuá»™t) Ä‘á»u Ä‘Æ°á»£c pháº£n há»“i chÃ­nh xÃ¡c.
- **`lua_chon`:** Tinh chá»‰nh di chuyá»ƒn cá»§a nhÃ¢n váº­t, Ä‘áº·c biá»‡t lÃ  cÆ¡ cháº¿ trÆ°á»£t tÆ°á»ng, táº¡o tráº£i nghiá»‡m di chuyá»ƒn mÆ°á»£t mÃ  vÃ  há»£p lÃ½.

---

### **Giáº£i thÃ­ch cÆ¡ cháº¿ má»›i Ä‘Ã¡ng chÃº Ã½**

#### **[CÆ¡ cháº¿ trÆ°á»£t tÆ°á»ng](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L407-L472)**

Do kÃ­ch thÆ°á»›c má»—i Ã´ pixel trong báº£n Ä‘á»“ lÃ  **40x40**, khi nhÃ¢n váº­t chá»‰ va cháº¡m nháº¹ (1 pixel) vÃ o tÆ°á»ng, viá»‡c di chuyá»ƒn sáº½ bá»‹ ngÄƒn láº¡i, gÃ¢y ra hiá»‡n tÆ°á»£ng "Ä‘á»©ng yÃªn" khÃ´ng mong muá»‘n mÃ  máº¯t thÆ°á»ng khÃ³ nháº­n biáº¿t. Äá»ƒ kháº¯c phá»¥c váº¥n Ä‘á» nÃ y, trÃ² chÆ¡i Ä‘Ã£ tÃ­ch há»£p má»™t **cÆ¡ cháº¿ trÆ°á»£t tÆ°á»ng**, giÃºp nhÃ¢n váº­t cÃ³ thá»ƒ linh hoáº¡t Ä‘iá»u chá»‰nh vá»‹ trÃ­ vÃ  tiáº¿p tá»¥c di chuyá»ƒn mÃ  khÃ´ng bá»‹ káº¹t.

---

### **Chi tiáº¿t hoáº¡t Ä‘á»™ng**

1. **XÃ¡c Ä‘á»‹nh vá»‹ trÃ­ va cháº¡m:**
   - TrÃ² chÆ¡i sá»­ dá»¥ng cÃ¡c tá»a Ä‘á»™ cá»§a nhÃ¢n váº­t (`x`, `y`, `w`, `h`) Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem cÃ³ va cháº¡m vá»›i cáº¡nh cá»§a tÆ°á»ng hay khÃ´ng. Logic sá»­ dá»¥ng phÃ©p XOR (`^`) Ä‘á»ƒ kiá»ƒm tra náº¿u **chá»‰ má»™t cáº¡nh va cháº¡m**, cÆ¡ cháº¿ trÆ°á»£t sáº½ Ä‘Æ°á»£c kÃ­ch hoáº¡t:
     ```cpp
     if(cham_tuong(w, y, bfs_map) ^ cham_tuong(w, h, bfs_map)) {
         ...
     }
     ```

2. **Táº¡o chuyá»ƒn Ä‘á»™ng trÆ°á»£t:**
   - Khi va cháº¡m Ä‘Æ°á»£c phÃ¡t hiá»‡n, nhÃ¢n váº­t sáº½ Ä‘Æ°á»£c thá»­ di chuyá»ƒn lÃªn hoáº·c xuá»‘ng (hoáº·c trÃ¡i hoáº·c pháº£i tÃ¹y theo hÆ°á»›ng va cháº¡m). Hai Ä‘á»‘i tÆ°á»£ng táº¡m thá»i `T1` vÃ  `T2` Ä‘Æ°á»£c táº¡o ra Ä‘á»ƒ kiá»ƒm tra vá»‹ trÃ­ má»›i:
     ```cpp
     OBJ T1 = player;
     OBJ T2 = player;
     T1.rect.y -= 2; // Thá»­ di chuyá»ƒn lÃªn.
     T2.rect.y += 2; // Thá»­ di chuyá»ƒn xuá»‘ng.
     ```

3. **Kiá»ƒm tra tÃ­nh há»£p lá»‡ cá»§a vá»‹ trÃ­ má»›i:**
   - Má»—i vá»‹ trÃ­ má»›i (`T1` vÃ  `T2`) Ä‘Æ°á»£c kiá»ƒm tra báº±ng hÃ m `cham_tuong` vÃ  `kiem_tra_va_cham`. Náº¿u há»£p lá»‡ (khÃ´ng cháº¡m tÆ°á»ng hoáº·c Ä‘á»‘i tÆ°á»£ng khÃ¡c), nhÃ¢n váº­t sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n vá»‹ trÃ­ Ä‘Ã³:
     ```cpp
     if(cham_tuong(w, y, bfs_map) == false && kiem_tra_va_cham(T1, T1, enemy_list, total_enemy, bfs_map) == false) {
         player = T1; // TrÆ°á»£t lÃªn.
     } else if(cham_tuong(w, h, bfs_map) == false && kiem_tra_va_cham(T2, T2, enemy_list, total_enemy, bfs_map) == false) {
         player = T2; // TrÆ°á»£t xuá»‘ng.
     }
     ```

4. **Äá»“ng nháº¥t trÃªn má»i hÆ°á»›ng:**
   - CÆ¡ cháº¿ trÆ°á»£t tÆ°Æ¡ng tá»± cÅ©ng Ä‘Æ°á»£c Ã¡p dá»¥ng khi nhÃ¢n váº­t di chuyá»ƒn **trÃ¡i**, **pháº£i**, hoáº·c theo chiá»u dá»c.

---

### **Ã nghÄ©a vÃ  tÃ¡c Ä‘á»™ng trong trÃ² chÆ¡i**

- **MÆ°á»£t mÃ  hÆ¡n:**
  - NgÆ°á»i chÆ¡i khÃ´ng gáº·p tÃ¬nh tráº¡ng nhÃ¢n váº­t "Ä‘á»©ng yÃªn" khi cháº¡m cáº¡nh tÆ°á»ng, mang láº¡i cáº£m giÃ¡c Ä‘iá»u khiá»ƒn mÆ°á»£t mÃ  vÃ  tá»± nhiÃªn.

- **Há»£p lÃ½ vá» váº­t lÃ½:**
  - CÆ¡ cháº¿ mÃ´ phá»ng cÃ¡ch cÃ¡c váº­t thá»ƒ trong tháº¿ giá»›i thá»±c cÃ³ xu hÆ°á»›ng "lÆ°á»›t" qua cÃ¡c gÃ³c cáº¡nh thay vÃ¬ bá»‹ káº¹t hoÃ n toÃ n.

- **Cáº£i thiá»‡n tráº£i nghiá»‡m:**
  - NgÆ°á»i chÆ¡i cáº£m nháº­n rÃµ sá»± tinh táº¿ trong thiáº¿t káº¿ Ä‘iá»u khiá»ƒn, giÃºp tÄƒng cÆ°á»ng sá»± thá»a mÃ£n khi tham gia trÃ² chÆ¡i.

---

### **VÃ­ dá»¥ minh há»a tá»« mÃ£ nguá»“n**

DÆ°á»›i Ä‘Ã¢y lÃ  Ä‘oáº¡n mÃ£ minh há»a viá»‡c kiá»ƒm tra vÃ  xá»­ lÃ½ cÆ¡ cháº¿ trÆ°á»£t tÆ°á»ng khi nhÃ¢n váº­t di chuyá»ƒn sang pháº£i:

```cpp
if(player.angle == 0) { // HÆ°á»›ng di chuyá»ƒn sang pháº£i.
    if(cham_tuong(w, y, bfs_map) ^ cham_tuong(w, h, bfs_map)) {
        OBJ T1 = player; // TrÆ°á»ng há»£p trÆ°á»£t lÃªn.
        OBJ T2 = player; // TrÆ°á»ng há»£p trÆ°á»£t xuá»‘ng.
        T1.rect.y -= 2;
        T2.rect.y += 2;

        if(cham_tuong(w, y, bfs_map) == false && kiem_tra_va_cham(T1, T1, enemy_list, total_enemy, bfs_map) == false) {
            player = T1;
        } else if(cham_tuong(w, h, bfs_map) == false && kiem_tra_va_cham(T2, T2, enemy_list, total_enemy, bfs_map) == false) {
            player = T2;
        }
    }
}
```

---


## XÃ¢y dá»±ng mÃ n chÆ¡i

### 1. MÃ´ hÃ¬nh mÃ n chÆ¡i
#### [Xem chi tiáº¿t á»Ÿ source_code/ui/play.cpp](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/play.cpp)

HÃ m `run_game` chá»‹u trÃ¡ch nhiá»‡m Ä‘iá»u khiá»ƒn toÃ n bá»™ logic cá»§a mÃ n chÆ¡i, tá»« khá»Ÿi táº¡o Ä‘áº¿n káº¿t thÃºc. CÃ¡c thÃ nh pháº§n chÃ­nh bao gá»“m:

- **Khá»Ÿi táº¡o mÃ n chÆ¡i:**  
  + Táº£i cÃ¡c tÃ i nguyÃªn nhÆ° hÃ¬nh áº£nh (ná»n, xe tÄƒng cá»§a ngÆ°á»i chÆ¡i, Ä‘á»‹ch, tÆ°á»ng, Ä‘áº¡n) vÃ  chuyá»ƒn Ä‘á»•i chÃºng thÃ nh `SDL_Texture` Ä‘á»ƒ váº½ lÃªn mÃ n hÃ¬nh.  
  + Má»Ÿ font chá»¯ dÃ¹ng cho HUD vÃ  banner.  
  + Äáº·t cá»­a sá»• game vá»›i kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh **1320x760** vÃ  cÄƒn giá»¯a mÃ n hÃ¬nh.  
  + Khá»Ÿi táº¡o cÃ¡c máº£ng lÆ°u trá»¯ tráº¡ng thÃ¡i cá»§a tÆ°á»ng vÃ  Ä‘Æ°á»ng Ä‘i, vÃ­ dá»¥ nhÆ° `wall_map[45][25]` vÃ  `bfs_map[45][25]`.

- **Xá»­ lÃ½ sá»± kiá»‡n:**  
  + Sá»­ dá»¥ng `handleEvent` Ä‘á»ƒ nháº­n cÃ¡c thao tÃ¡c tá»« ngÆ°á»i chÆ¡i nhÆ° di chuyá»ƒn (W, A, S, D hoáº·c mÅ©i tÃªn), báº¯n Ä‘áº¡n (SPACE), táº¡m dá»«ng (P) hay thoÃ¡t (/quay láº¡i menu báº±ng M).

- **Cáº­p nháº­t tráº¡ng thÃ¡i:**  
  + Cáº­p nháº­t vá»‹ trÃ­ cá»§a nhÃ¢n váº­t qua hÃ m `lua_chon` dá»±a theo cÃ¡c thao tÃ¡c Ä‘iá»u khiá»ƒn vÃ  kiá»ƒm tra va cháº¡m.  
  + Xá»­ lÃ½ AI cá»§a Ä‘á»‹ch báº±ng hÃ m `Auto_ACT`, táº¡o cÃ¡c hÃ nh vi ngáº«u nhiÃªn vÃ  linh hoáº¡t cá»§a xe tÄƒng Ä‘á»‹ch.  
  + Quáº£n lÃ½ Ä‘á»‘i tÆ°á»£ng Ä‘áº¡n: khá»Ÿi táº¡o, cáº­p nháº­t vá»‹ trÃ­ (vá»›i hÃ m `new_obj_location`), kiá»ƒm tra Ä‘Æ°á»ng Ä‘i (vá»›i hÃ m `kiem_tra_duong_dan`), vÃ  hiá»ƒn thá»‹ Ä‘áº¡n.

- **Hiá»ƒn thá»‹ mÃ n hÃ¬nh:**  
  + Má»—i khung hÃ¬nh (frame) Ä‘Æ°á»£c váº½ láº¡i bao gá»“m cÃ¡c thÃ nh pháº§n:  
    - **Ná»n:** hiá»ƒn thá»‹ hÃ¬nh ná»n game.  
    - **NhÃ¢n váº­t:** xe tÄƒng cá»§a ngÆ°á»i chÆ¡i.  
    - **Äá»‹ch:** xe tÄƒng cá»§a Ä‘á»‘i thá»§.  
    - **Váº­t cáº£n (tÆ°á»ng):** hiá»ƒn thá»‹ cÃ¡c tÆ°á»ng Ä‘Æ°á»£c khá»Ÿi táº¡o.  
    - **Äáº¡n:** hiá»ƒn thá»‹ Ä‘áº¡n cá»§a cáº£ ngÆ°á»i chÆ¡i vÃ  Ä‘á»‹ch.  
  + HUD vÃ  banner Ä‘Æ°á»£c váº½ Ä‘á»ƒ cung cáº¥p thÃ´ng tin vá» level, Ä‘iá»ƒm sá»‘, Ä‘iá»ƒm cao nháº¥t vÃ  sá»‘ máº¡ng cÃ²n láº¡i.

- **Äiá»u kiá»‡n káº¿t thÃºc:**  
  + MÃ n chÆ¡i káº¿t thÃºc khi ngÆ°á»i chÆ¡i háº¿t máº¡ng (hiá»ƒn thá»‹ â€œGAME OVERâ€) hoáº·c khi ngÆ°á»i chÆ¡i chá»n thoÃ¡t (báº±ng phÃ­m M).

---

### 2. CÆ¡ cháº¿ lÃªn level

- **TÄƒng cáº¥p Ä‘á»™:**  
  Sau má»—i mÃ n chÆ¡i, náº¿u ngÆ°á»i chÆ¡i tiÃªu diá»‡t háº¿t Ä‘á»‹ch hiá»‡n há»¯u, trÃ² chÆ¡i sáº½ tÄƒng lÃªn cáº¥p Ä‘á»™ má»›i.  
  + Sá»‘ lÆ°á»£ng Ä‘á»‹ch vÃ  tÆ°á»ng Ä‘Æ°á»£c sinh ra sáº½ tÄƒng theo Ä‘á»™ khÃ³ cá»§a cáº¥p Ä‘á»™.
  + NgÆ°á»i chÆ¡i thay Ä‘á»•i cÃ¡c thÃ´ng sá»‘ trÃªn báº£n Ä‘á»“, mang láº¡i thá»­ thÃ¡ch má»›i máº» qua má»—i level.

- **Pháº§n thÆ°á»Ÿng:**  
  + NgÆ°á»i chÆ¡i Ä‘Æ°á»£c nháº­n thÃªm **1 máº¡ng** sau má»—i mÃ n chÆ¡i thÃ nh cÃ´ng.
  + Äiá»ƒm sá»‘ Ä‘Æ°á»£c tÃ­nh dá»±a trÃªn sá»‘ lÆ°á»£ng Ä‘á»‹ch tiÃªu diá»‡t vÃ  cáº¥p Ä‘á»™ hiá»‡n táº¡i, giÃºp ngÆ°á»i chÆ¡i cÃ³ Ä‘á»™ng lá»±c cáº£i thiá»‡n ká»¹ nÄƒng.

- **Khá»Ÿi táº¡o láº¡i báº£n Ä‘á»“:**  
  + HÃ m `map_khoi_dong` Ä‘Æ°á»£c gá»i Ä‘á»ƒ táº¡o láº¡i báº£n Ä‘á»“ má»›i cho tá»«ng level, vá»›i cÃ¡c vá»‹ trÃ­ nhÃ¢n váº­t, Ä‘á»‹ch vÃ  tÆ°á»ng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh má»™t cÃ¡ch ngáº«u nhiÃªn vÃ  cÃ¢n báº±ng.

---

### 3. SÆ¡ Ä‘á»“ logic mÃ n chÆ¡i

```plaintext
+--------------------+
|   Khá»Ÿi táº¡o mÃ n chÆ¡i |
+--------------------+
          |
          v
+--------------------+
| Xá»­ lÃ½ sá»± kiá»‡n      |
| (handleEvent)      |
+--------------------+
          |
          v
+--------------------+
| Cáº­p nháº­t tráº¡ng thÃ¡i|
| - Di chuyá»ƒn nhÃ¢n váº­t|
| - AI cá»§a Ä‘á»‹ch       |
| - Xá»­ lÃ½ Ä‘áº¡n báº¯n     |
+--------------------+
          |
          v
+--------------------+
|   Hiá»ƒn thá»‹ mÃ n hÃ¬nh |
+--------------------+
          |
          v
+--------------------+
| Äiá»u kiá»‡n káº¿t thÃºc  |
| - GAME OVER         |
| - LÃªn level         |
+--------------------+
```
---
### 4. Ã nghÄ©a cá»§a mÃ´ hÃ¬nh mÃ n chÆ¡i
- **Äa dáº¡ng vÃ  ngáº«u nhiÃªn:** Má»—i mÃ n chÆ¡i Ä‘Æ°á»£c khá»Ÿi táº¡o vá»›i vá»‹ trÃ­ Ä‘á»‘i tÆ°á»£ng ngáº«u nhiÃªn nhá» cÃ¡c hÃ m nhÆ° map_khoi_dong vÃ  bfs_area, táº¡o ra tráº£i nghiá»‡m Ä‘á»™c Ä‘Ã¡o vÃ  khÃ´ng láº·p láº¡i.

- **TÄƒng Ä‘á»™ khÃ³:** Khi level tÄƒng, sá»‘ lÆ°á»£ng Ä‘á»‹ch vÃ  tÆ°á»ng gia tÄƒng, Ä‘Ã²i há»i ngÆ°á»i chÆ¡i pháº£i Ä‘á»‘i máº·t vá»›i thá»­ thÃ¡ch vÃ  tinh chá»‰nh chiáº¿n lÆ°á»£c.

- **Tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng:** Viá»‡c hiá»ƒn thá»‹ HUD vÃ  banner cung cáº¥p thÃ´ng tin ká»‹p thá»i, giÃºp ngÆ°á»i chÆ¡i theo dÃµi Ä‘iá»ƒm sá»‘, máº¡ng vÃ  cáº¥p Ä‘á»™ má»™t cÃ¡ch trá»±c quan, Ä‘á»“ng thá»i duy trÃ¬ sá»± háº¥p dáº«n khi tham gia trÃ² chÆ¡i.

---

## Simple AI - XÃ¢y dá»±ng AI Ä‘Æ¡n giáº£n cho game

[HÃ m `Auto_ACT` lÃ  trung tÃ¢m cá»§a há»‡ thá»‘ng trÃ­ tuá»‡ nhÃ¢n táº¡o (AI) trong trÃ² chÆ¡i **Tank Of Battle**, chá»‹u trÃ¡ch nhiá»‡m Ä‘iá»u khiá»ƒn hÃ nh vi cá»§a Ä‘á»‹ch, bao gá»“m di chuyá»ƒn vÃ  báº¯n Ä‘áº¡n. HÃ m nÃ y mÃ´ phá»ng má»™t AI Ä‘Æ¡n giáº£n nhÆ°ng hiá»‡u quáº£, dá»±a trÃªn khoáº£ng cÃ¡ch Ä‘áº¿n ngÆ°á»i chÆ¡i, logic bÃ¡m Ä‘uá»•i, vÃ  ngáº«u nhiÃªn hÃ³a hÃ nh vi.](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L202-L338)

---

### **[Chi tiáº¿t hoáº¡t Ä‘á»™ng cá»§a hÃ m `Auto_ACT`](https://github.com/dinhkien0701/battle-of-tank/blob/main/source_code/ui/act.cpp#L202-L338)**

### **1. Thay Ä‘á»•i hÆ°á»›ng di chuyá»ƒn ngáº«u nhiÃªn**
- Má»—i khi `clock == 90`, Ä‘á»‹ch sáº½ thay Ä‘á»•i hÆ°á»›ng di chuyá»ƒn báº±ng cÃ¡ch chá»n ngáº«u nhiÃªn trong cÃ¡c gÃ³c 0Â°, 90Â°, 180Â°, 270Â°.  
- GiÃ¡ trá»‹ cá»§a `clock` sau Ä‘Ã³ Ä‘Æ°á»£c Ä‘áº·t láº¡i vá»›i má»™t sá»‘ ngáº«u nhiÃªn tá»« 0 Ä‘áº¿n 19 Ä‘á»ƒ trÃ¡nh sá»± láº·p láº¡i thÆ°á»ng xuyÃªn.

```cpp
if (enemy.clock == 90) {
    srand(enemy.rect.x * enemy.rect.y + enemy.angle + time(0));
    enemy.angle = 90 * (rand() % 4);
    enemy.clock = rand() % 20;
}
enemy.clock++;
```
---
### **2. Quyáº¿t Ä‘á»‹nh báº¯n Ä‘áº¡n** 
- Äá»‹ch sáº½ quyáº¿t Ä‘á»‹nh báº¯n Ä‘áº¡n dá»±a vÃ o:

- Táº§n suáº¥t: Äá»‹ch chá»‰ báº¯n náº¿u `rand_shot` khá»›p vá»›i giÃ¡ trá»‹ `fps`.

- Cáº¥p Ä‘á»™: á» `level` tháº¥p hÆ¡n `(level < 3)`, kháº£ nÄƒng báº¯n Ä‘áº¡n Ä‘Æ°á»£c giáº£m Ä‘á»ƒ giÃºp ngÆ°á»i chÆ¡i lÃ m quen. á» cÃ¡c cáº¥p Ä‘á»™ cao hÆ¡n, Ä‘á»‹ch sáº½ báº¯n Ä‘áº¡n thÆ°á»ng xuyÃªn hÆ¡n.

```cpp
if (enemy.rand_shot == fps) {
    if (level < 3) {
        srand(enemy.rect.x);
        shot = static_cast<bool>(rand() % 2);
    } else {
        shot = true;
    }
}
```
---
### 3. TÃ­nh khoáº£ng cÃ¡ch vÃ  logic bÃ¡m Ä‘uá»•i
- Khoáº£ng cÃ¡ch vá»›i ngÆ°á»i chÆ¡i: Äá»‹ch sáº½ phÃ¢n tÃ­ch khoáº£ng cÃ¡ch giá»¯a vá»‹ trÃ­ cá»§a mÃ¬nh vÃ  ngÆ°á»i chÆ¡i (dist) Ä‘á»ƒ quyáº¿t Ä‘á»‹nh hÃ nh vi. Äá»‹ch sáº½ cÄƒn cá»© vÃ o `level` cÃ ng cao vÃ  Ä‘áº·c biá»‡t lÃ  khoáº£ng
cÃ¡ch `dist`  cÃ ng gáº§n , sá»± Ä‘uá»•i theo cÃ ng quyáº¿t liá»‡t

- Dá»±a vÃ o cÃ¡c cÃ´ng thá»©c tÃ­nh qua `level` , `dist` vÃ  sá»­ dá»¥ng `random` Ä‘á»ƒ láº¥y giÃ¡ trá»‹ ` int choose ` , náº¿u `choose > 7` Ä‘á»‹ch sáº½ Ä‘uá»•i theo

- Logic kiá»ƒm tra: Dá»±a vÃ o sá»± chÃªnh lá»‡ch tá»a Ä‘á»™ giá»¯a Ä‘á»‹ch vÃ  ngÆ°á»i chÆ¡i (x, y), AI sáº½ tÃ­nh toÃ¡n hÆ°á»›ng di chuyá»ƒn.


```cpp
// táº¡o háº¡t nhÃ¢n cho random
    srand( enemy.rect.x-enemy.rect.y + enemy.angle);

    int choose = rand()%9 + min(2, level/3); // random láº¥y sá»‘ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ³ Ä‘uá»•i khÃ´ng (>7)

    if(dist <= 150 + min(level*20,200)||choose >7){

        // HÃ m kiá»ƒm tra cÃ³ báº¯n Ä‘áº¡n khÃ´ng
        if((enemy.rand_shot == fps)){
            shot = true ;
        }
        if(dist< 70){
            if((fps+30)%60 == enemy.rand_shot){
                shot = true;
            }
        }

         // táº¡o háº¡t nhÃ¢n cho random
         srand(enemy.rect.y);
         //tiáº¿p tá»¥c láº¥y sá»‘ láº§n ná»¯a
         choose = choose/7*7 + rand()%10 + min(4,level/2) + max(0 ,3-dist/50) ; // random láº¥y sá»‘ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ³ Ä‘uá»•i khÃ´ng (>7)

         if(choose > 7) {  Khi choose >7 káº» Ä‘á»‹ch thá»±c hiá»‡n bÃ¡m Ä‘uá»•i ngÆ°á»i chÆ¡i .... }
```
----

### **4. TÃ¬m Ä‘Æ°á»ng tá»‘i Æ°u**
- AI phÃ¢n tÃ­ch táº¥t cáº£ 4 hÆ°á»›ng di chuyá»ƒn (xoay 0Â°, 90Â°, 180Â°, 270Â°) Ä‘á»ƒ tÃ¬m hÆ°á»›ng cÃ³ giÃ¡ trá»‹ tá»‘t nháº¥t dá»±a trÃªn hÃ m `find_path`.

 ```cpp
int find_path( SDL_Rect &rect , int bfs_map[45][25]){
    int ans =0;
    if(rect.x <0 || rect.x +rect.w > 1320 || rect.y <40 ||rect.y+rect.h >760){
        // trÆ°á»ng há»£p ngoÃ i viá»n , loáº¡i bá» luÃ´n
        return 100000000;
    }
    vector<int> rect_Rows ={rect.x/40 , (rect.x+rect.w-1)/40};
    vector<int> rect_Cols ={rect.y/40 , (rect.y+rect.h-1)/40};
    for(int X :rect_Rows){
        for(int Y :rect_Cols){
            ans += abs(bfs_map[X][Y]);
        }
    }
    return ans ;
}
```


- **Logic kiá»ƒm tra:** Náº¿u hÆ°á»›ng Ä‘Æ°á»£c chá»n cÃ³ Ä‘iá»ƒm sá»‘ tá»‘t hÆ¡n vÃ  khÃ´ng va cháº¡m, AI sáº½ cáº­p nháº­t hÆ°á»›ng vÃ  vá»‹ trÃ­ di chuyá»ƒn.

```cpp
for (int i = 0; i < 4; i++) {
    enemy_test = enemy;
    enemy_test.angle = (enemy.angle + 90 * i) % 360;
    new_obj_location(enemy_test.rect, enemy_test.angle, 2);

    if (kiem_tra_va_cham(enemy_test, player, enemy_list, total_enemy, bfs_map) == false) {
        enemy = enemy_test;
        return shot;
    }
}
```
### 5. Äiá»u chá»‰nh á»Ÿ khoáº£ng cÃ¡ch gáº§n
- Trong quÃ¡ trÃ¬nh bÃ¡m Ä‘uá»•i xe tÄƒng Ä‘á»‹ch xe Æ°u tiÃªn giáº£m khoáº£ng cÃ¡ch Ä‘á»ƒ tiáº¿p cáº­n má»¥c tiÃªu lÃ  ngÆ°á»i chÆ¡i
- Náº¿u khoáº£ng cÃ¡ch giá»¯a Ä‘á»‹ch vÃ  ngÆ°á»i chÆ¡i nhá» hÆ¡n `75 Ä‘áº¿n 95 pixel` tÃ¹y vÃ o Ä‘á»™ khÃ³ `level`, AI khi Ä‘Ã³ sáº½ vÃ´ cÃ¹ng thÃ´ng minh ( cÃ ng gáº§n ngÆ°á»i chÆ¡i cÃ ng thÃ´ng minh ) khi
Ä‘Ã³ Ä‘á»‹ch sáº½ Æ°u tiÃªn lÃ m sao chÄ©a nÃ²ng sÃºng vá» ngÆ°á»i chÆ¡i Ä‘á»ƒ tiÃªu diá»‡t

```cpp
if (max(abs(x), abs(y)) < 75 + min(20, level * 3)) {
    if (abs(x) <= abs(y)) {
        enemy_test = enemy;
        enemy_test.rect.x += 2 * x / abs(x);
        if (kiem_tra_va_cham(enemy_test, player, enemy_list, total_enemy, bfs_map) == false) {
            pick_rect = enemy_test.rect;
            if (x > 0) angle = 0;
            else angle = 180;
            break;
        }
    }
    ...
}
```
---
### 6. Ã nghÄ©a cá»§a AI trong game

- **ThÃ¡ch thá»©c thÃ´ng minh:** AI khÃ´ng chá»‰ báº¯n Ä‘áº¡n, mÃ  cÃ²n tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh hÆ°á»›ng di chuyá»ƒn Ä‘á»ƒ táº¡o ra thá»­ thÃ¡ch cho ngÆ°á»i chÆ¡i.

- **Pháº£n á»©ng theo cáº¥p Ä‘á»™:** Táº§n suáº¥t báº¯n Ä‘áº¡n vÃ  Ä‘á»™ phá»©c táº¡p trong hÃ nh vi cá»§a Ä‘á»‹ch tÄƒng lÃªn khi level cao hÆ¡n, Ä‘áº£m báº£o Ä‘á»™ khÃ³ Ä‘Æ°á»£c duy trÃ¬.

- **HÃ nh vi ngáº«u nhiÃªn:** Logic random trong AI giÃºp hÃ nh vi cá»§a Ä‘á»‹ch khÃ´ng dá»… Ä‘oÃ¡n, mang láº¡i sá»± má»›i máº» trong má»—i mÃ n chÆ¡i.
